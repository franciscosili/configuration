#!/bin/zsh

# cd-ing up
function cd_up() {
  cd $(printf "%0.s../" $(seq 1 $1 ));
}

# compress files
compress(){
    local input="$1"
    local output="$2"

    echo "tar -czvf ${output}.tar.gz ${input}"
    tar -czvf ${output}.tar.gz ${input}
}

# Download and decompress files
dldc(){
    local input="$1"
    local output="$2"
    if [[ ! -z "$input" && ! -z "$output" ]]; then
        local download="sftp fsili@lxplus.cern.ch:${input}.tar.gz ${output}.tar.gz"
        local decompress="tar -xvf ${output} ${output}.tar.gz"
        echo Downloading file ${input}.tar.gz into ${output}.tar.gz
        eval $dowload
        echo Decompressing file ${output}.tar.gz into ${output}
        eval $decompress
    else
        echo "Input and output not set.";
        echo "Usage: dldc <input_file> <output_file>"
    fi
}

# Connect to lxplus
lxp(){
    local server="$1"
    local user="fsili"
    if [[ ! -z "$server" ]]; then
        #local ssh_cmd="ssh -o GSSAPIAuthentication=no -o PreferredAuthentications=keyboard-interactive ${user}@lxplus${server}.cern.ch"
        local ssh_cmd="ssh ${user}@lxplus${server}.cern.ch"
    else
        local ssh_cmd="ssh ${user}@lxplus.cern.ch"
    fi

    echo ${ssh_cmd}
    eval ${ssh_cmd}
}
